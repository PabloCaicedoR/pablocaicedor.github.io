---
title: "Transformada de Laplace y Transformada Z en el Análisis de Señales Biomédicas"
subtitle: "Fundamentos y Aplicaciones"
description: "SYSB"
lang: es
author: "Ph.D. Pablo Eduardo Caicedo Rodríguez"
date: "`r Sys.Date()`"
format:
  html:
    code-tools: true
    code-overflow: scroll
    code-line-numbers: true
    code-copy: true
    fig-align: center
    self-contained: true
    theme:
      - simple
      - ../../../recursos/estilos/metropolis.scss
    slide-number: true
    preview-links: auto
    logo: ../../../recursos/imagenes/generales/Escuela_Rosario_logo.png
    css: ../../../recursos/estilos/styles_pres.scss
    footer: <https://pablocaicedor.github.io/>
    transition: fade
    progress: true
    scrollable: true

resources:
  - demo.pdf
---

```{r}
#| echo: false
#| eval: true
#| output: false
#| label: Loading R-Libraries
# install.packages(c("DiagrammeR", "reticulate", "kableExtra", "tidyverse", "knitr", "cowplot", "ggfx"))
library("DiagrammeR")
library("reticulate")
library("kableExtra")
library("tidyverse")
library("knitr")
library("cowplot")
library("ggfx")
knitr::opts_chunk$set(echo = FALSE)

def.chunk.hook <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
    x <- def.chunk.hook(x, options)
    ifelse(options$size != "normalsize", paste0("\n \\", options$size, "\n\n", x, "\n\n \\normalsize"), x)
})
```

```{python}
#| echo: false
#| eval: true
#| output: false
#| label: Loading Python-Libraries

import numpy as np
import matplotlib.pyplot as plt
path_ecg="../../data"

#https://developer.nvidia.com/embedded/learn/get-started-jetson-nano-devkit#write

```


# 1. Introducción

## 1.1. Contexto General

El cuerpo humano es un sistema complejo que genera una multitud de señales fisiológicas. La captura y el análisis de estas señales biomédicas, como el Electrocardiograma (ECG), el Electroencefalograma (EEG) o el Electromiograma (EMG), son cruciales para la medicina moderna. Estas señales, en su forma cruda, están frecuentemente contaminadas por ruido (artefactos) o contienen información superpuesta que debe ser separada y analizada [1].

El procesamiento digital y analógico de señales ofrece un conjunto de herramientas matemáticas para aislar componentes de interés, diseñar filtros y modelar sistemas fisiológicos. Históricamente, el análisis se realizaba en el dominio del tiempo, observando la evolución de la señal cronológicamente. Sin embargo, muchas propiedades de las señales y de los sistemas que las procesan (como los filtros) son mucho más fáciles de entender y manipular en un dominio transformado.

## 1.2. Objetivo del Reporte

El objetivo de este reporte es presentar los fundamentos teóricos y las aplicaciones prácticas de dos de las herramientas de transformación más importantes en la ingeniería: la **Transformada de Laplace (TL)** y la **Transformada Z (TZ)**.

La Transformada de Laplace es la herramienta por excelencia para el análisis de señales y sistemas en **tiempo continuo (CT)**. Permite modelar componentes analógicos, analizar la estabilidad de sistemas y resolver ecuaciones diferenciales lineales que describen fenómenos fisiológicos.

Por otro lado, la Transformada Z es la contraparte directa de la TL para el análisis de señales y sistemas en **tiempo discreto (DT)**. Dado que el procesamiento moderno de señales se realiza casi exclusivamente en computadoras digitales, la TZ es fundamental para diseñar, implementar y analizar filtros digitales que operan sobre señales biomédicas muestreadas.

Este documento está dirigido a estudiantes de pregrado en ingeniería biomédica y asume un conocimiento básico de cálculo y estadística descriptiva.

# 2. Fundamentos Teóricos

## 2.1. Transformada de Laplace (TL)

La Transformada de Laplace es una generalización de la Transformada de Fourier de Tiempo Continuo (CTFT). Mientras que la CTFT analiza una señal en términos de sus componentes senoidales (frecuencia $j\omega$), la TL la analiza en términos de exponenciales complejas (frecuencia compleja $s = \sigma + j\omega$). Este componente $\sigma$ (sigma) permite a la TL analizar no solo la respuesta en frecuencia estacionaria, sino también el comportamiento transitorio y la estabilidad de los sistemas.

### 2.1.1. Definición

Para una señal en tiempo continuo $f(t)$, la Transformada de Laplace unilateral (que asume $f(t) = 0$ para $t < 0$, común en sistemas causales) se define como:

$$
F(s) = \mathcal{L}\{f(t)\} = \int_{0^{-}}^{\infty} f(t) e^{-st} dt
$$

Donde $s$ es la variable de frecuencia compleja, $s = \sigma + j\omega$. La función $F(s)$ resultante existe en el "plano s" (s-plane).

### 2.1.2. Región de Convergencia (ROC)

La integral de Laplace no converge para todos los valores de $s$. El conjunto de valores $s$ para los cuales la integral converge se denomina Región de Convergencia (ROC). La ROC es crucial para definir unívocamente la señal en el tiempo, ya que diferentes señales $f(t)$ pueden tener la misma expresión $F(s)$ pero diferir en sus ROCs. Para sistemas causales y estables, la ROC siempre incluye el eje $j\omega$ (el eje imaginario).

### 2.1.3. Propiedades Clave de la TL

La utilidad de la TL proviene de sus propiedades algebraicas, que convierten operaciones complejas en el dominio del tiempo (como la diferenciación, integración y convolución) en operaciones algebraicas simples en el dominio $s$.

\begin{table}[h!]
\centering
\caption{Propiedades Fundamentales de la Transformada de Laplace Unilateral.}
\label{tab:laplace_props}
\begin{tabular}{lll}
\hline
\textbf{Propiedad} & \textbf{Dominio del Tiempo ($f(t)$)} & \textbf{Dominio $s$ ($F(s)$)} \\ \hline
Linealidad & $a f_1(t) + b f_2(t)$ & $a F_1(s) + b F_2(s)$ \\
Diferenciación & $\frac{d f(t)}{dt}$ & $s F(s) - f(0^{-})$ \\
Integración & $\int_{0}^{t} f(\tau) d\tau$ & $\frac{1}{s} F(s)$ \\
Desplazamiento en $t$ & $f(t-a)u(t-a)$ & $e^{-as} F(s)$ \\
Desplazamiento en $s$ & $e^{-at} f(t)$ & $F(s+a)$ \\
Convolución & $f_1(t) * f_2(t)$ & $F_1(s) \cdot F_2(s)$ \\ \hline
\end{tabular}
\end{table}

### 2.1.4. Ejemplo Básico: Función Exponencial

Consideremos una función exponencial decreciente, $f(t) = e^{-at}u(t)$, donde $u(t)$ es la función escalón unitario. Esta forma es la base de muchas respuestas de sistemas (p.ej., la descarga de un capacitor).

$$
F(s) = \int_{0}^{\infty} e^{-at} e^{-st} dt = \int_{0}^{\infty} e^{-(s+a)t} dt
$$
$$
F(s) = \left[ \frac{-1}{s+a} e^{-(s+a)t} \right]_{0}^{\infty}
$$

Esta integral converge solo si la parte real de $(s+a)$ es positiva, es decir, $Re\{s\} + a > 0$ o $Re\{s\} > -a$. Esta es la ROC.

$$
F(s) = 0 - \left( \frac{-1}{s+a} e^{0} \right) = \frac{1}{s+a}
$$

## 2.2. Transformada Z (TZ)

La Transformada Z es la contraparte de la Transformada de Laplace para señales y sistemas de tiempo discreto (DT). Es la herramienta matemática fundamental para el procesamiento digital de señales.

### 2.2.1. Definición

Para una secuencia de tiempo discreto $x[n]$ (una señal muestreada), la Transformada Z bilateral se define como:

$$
X(z) = \mathcal{Z}\{x[n]\} = \sum_{n=-\infty}^{\infty} x[n] z^{-n}
$$

Donde $z$ es una variable compleja. En la práctica, para secuencias causales (que inician en $n=0$), se usa la TZ unilateral:

$$
X(z) = \sum_{n=0}^{\infty} x[n] z^{-n}
$$

### 2.2.2. Región de Convergencia (ROC)

Al igual que la TL, la TZ tiene una ROC, que es el conjunto de valores $z$ (en el "plano z") para los cuales la suma converge. Para señales DT, la estabilidad se relaciona con la **circunferencia unitaria** (el círculo de radio 1 en el plano z). Un sistema LTI (Lineal e Invariante en el Tiempo) discreto es estable si y solo si su ROC incluye la circunferencia unitaria.

### 2.2.3. Propiedades Clave de la TZ

Las propiedades de la TZ son análogas a las de la TL y son igualmente poderosas para el análisis de sistemas discretos (como los filtros digitales).

\begin{table}[h!]
\centering
\caption{Propiedades Fundamentales de la Transformada Z Unilateral.}
\label{tab:z_props}
\begin{tabular}{lll}
\hline
\textbf{Propiedad} & \textbf{Dominio del Tiempo ($x[n]$)} & \textbf{Dominio $z$ ($X(z)$)} \\ \hline
Linealidad & $a x_1[n] + b x_2[n]$ & $a X_1(z) + b X_2(z)$ \\
Retardo (Delay) & $x[n-k]u[n-k]$ & $z^{-k} X(z)$ \\
Adelanto (Shift) & $x[n+1]u[n]$ & $z X(z) - z x[0]$ \\
Multiplicación por $a^n$ & $a^n x[n]$ & $X(a^{-1}z)$ \\
Convolución & $x_1[n] * x_2[n]$ & $X_1(z) \cdot X_2(z)$ \\ \hline
\end{tabular}
\end{table}

### 2.2.4. Ejemplo Básico: Exponencial Discreta

Consideremos la secuencia exponencial causal $x[n] = a^n u[n]$.

$$
X(z) = \sum_{n=0}^{\infty} a^n z^{-n} = \sum_{n=0}^{\infty} (a z^{-1})^n
$$

Esta es una serie geométrica. Converge a $\frac{1}{1-r}$ si $|r| < 1$. En nuestro caso, $r = a z^{-1}$.
La serie converge si $|a z^{-1}| < 1$, o $|z| > |a|$. Esta es la ROC.

$$
X(z) = \frac{1}{1 - a z^{-1}} = \frac{z}{z-a}
$$

# 3. Aplicaciones en Señales Biomédicas

## 3.1. Caso 1: Análisis de ECG y Transformada de Laplace

Aunque la mayoría del procesamiento de ECG hoy en día es digital, la Transformada de Laplace es indispensable para **modelar el sistema de adquisición y los filtros analógicos** (anti-aliasing) que preceden a la digitalización [1].

**Problema:** Una señal de ECG está contaminada con ruido de alta frecuencia (p.ej., interferencia de la línea de alimentación de 60 Hz o ruido muscular EMG). Antes de muestrear la señal (digitalizarla), se debe usar un filtro analógico pasa-bajos.

**Solución con TL:** Se puede diseñar un filtro RC (Resistor-Capacitor) simple. Este es un sistema LTI de tiempo continuo.
[Image of RC low-pass filter circuit diagram]

La ecuación diferencial que describe este circuito es:
$V_{in}(t) = R \cdot i(t) + V_{out}(t)$
$i(t) = C \frac{d V_{out}(t)}{dt}$

Sustituyendo $i(t)$:
$V_{in}(t) = RC \frac{d V_{out}(t)}{dt} + V_{out}(t)$

Aplicamos la Transformada de Laplace (usando la propiedad de diferenciación $s F(s)$ y asumiendo condiciones iniciales cero):
$V_{in}(s) = RC \cdot s V_{out}(s) + V_{out}(s)$
$V_{in}(s) = V_{out}(s) (RCs + 1)$

La **Función de Transferencia** $H(s)$ del sistema es la relación entre la salida y la entrada en el dominio $s$:
$$
H(s) = \frac{V_{out}(s)}{V_{in}(s)} = \frac{1}{RCs + 1}
$$

Esta $H(s)$ describe completamente el filtro. La frecuencia de corte (frecuencia a la cual la potencia de la señal se reduce a la mitad) es $\omega_c = 1/RC$. Al elegir $R$ y $C$ apropiados, se puede establecer una frecuencia de corte (p.ej., 100 Hz) para atenuar el ruido de alta frecuencia antes de que la señal ECG sea digitalizada, previniendo el fenómeno de *aliasing*. La TL permite analizar la estabilidad y la respuesta en frecuencia de este componente analógico de forma sencilla.

## 3.2. Caso 2: Análisis de EEG y Transformada Z

El EEG mide la actividad eléctrica cerebral. El análisis clínico y de investigación requiere aislar bandas de frecuencia específicas (Delta: 0.5-4 Hz, Theta: 4-8 Hz, Alpha: 8-12 Hz, Beta: 12-30 Hz) [2]. Este filtrado se realiza digitalmente después de que la señal ha sido muestreada.

**Problema:** Aislar la banda Alpha (8-12 Hz) de una señal EEG muestreada a 250 Hz.

**Solución con TZ:** Se debe diseñar un filtro digital pasa-banda. Los filtros digitales se describen mediante **ecuaciones de diferencia** (la contraparte discreta de las ecuaciones diferenciales).

Un filtro digital simple (aunque no muy selectivo) es un filtro de media móvil (Moving Average, MA), que es un tipo de filtro de Respuesta Finita al Impulso (FIR):
$y[n] = \frac{1}{M} \sum_{k=0}^{M-1} x[n-k]$

Aplicando la Transformada Z (usando la propiedad de retardo $z^{-k}X(z)$):
$Y(z) = \frac{1}{M} \sum_{k=0}^{M-1} z^{-k} X(z)$
$Y(z) = X(z) \cdot \left[ \frac{1}{M} \sum_{k=0}^{M-1} (z^{-1})^k \right]$

La Función de Transferencia $H(z)$ es:
$$
H(z) = \frac{Y(z)}{X(z)} = \frac{1}{M} \frac{1 - (z^{-1})^M}{1 - z^{-1}}
$$

Aunque este filtro es pasa-bajos, filtros más complejos (como los IIR, Infinite Impulse Response, p.ej., Butterworth o Chebyshev) se diseñan directamente en el dominio $z$ (o se convierten desde el dominio $s$) para obtener la selectividad de frecuencia deseada (pasa-banda) [3]. La $H(z)$ de un filtro IIR toma la forma de una función racional (un polinomio en $z^{-1}$ dividido por otro), que es la base del procesamiento digital de señales:

$$
H(z) = \frac{\sum_{k=0}^{M} b_k z^{-k}}{1 + \sum_{k=1}^{N} a_k z^{-k}} = \frac{B(z)}{A(z)}
$$
Los coeficientes $b_k$ y $a_k$ son los que se implementan en el software (como Python o MATLAB) para filtrar la señal EEG.

# 4. Implementación Práctica en Python

La teoría de la Transformada Z se materializa en la práctica mediante los coeficientes de la función de transferencia $H(z)$. La biblioteca `scipy.signal` de Python es la herramienta estándar para diseñar y aplicar estos filtros.

El siguiente ejemplo muestra cómo diseñar un filtro digital Butterworth (un tipo de filtro IIR) para extraer la banda Alpha (8-12 Hz) de una señal, como se describió en el caso del EEG.

```{{python}}
#| label: fig-eeg-filter
#| fig-cap: "Simulación de filtrado de una señal EEG. (Arriba) Señal simulada con componentes de 10 Hz (Alpha) y 50 Hz (Ruido). (Abajo) Señal filtrada mostrando solo la componente Alpha de 10 Hz."
import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import butter, lfilter, freqz

# --- 1. Definir parámetros de la señal y el filtro ---
FS = 250  # Frecuencia de muestreo (Hz), típica para EEG
LOWCUT = 8.0  # Frecuencia de corte inferior (Hz)
HIGHCUT = 12.0 # Frecuencia de corte superior (Hz)
ORDER = 4     # Orden del filtro

def butter_bandpass(lowcut, highcut, fs, order=5):
    """Diseña los coeficientes del filtro (numerador b, denominador a)"""
    nyq = 0.5 * fs  # Frecuencia de Nyquist
    low = lowcut / nyq
    high = highcut / nyq
    # La función 'butter' diseña el filtro y retorna
    # los coeficientes de H(z) = B(z) / A(z)
    b, a = butter(order, [low, high], btype='band')
    return b, a

def apply_filter(data, b, a):
    """Aplica el filtro a la señal usando la ecuación de diferencia"""
    # lfilter implementa la operación H(z)X(z) en el dominio del tiempo
    y = lfilter(b, a, data)
    return y

# --- 2. Crear una señal EEG simulada ---
# t = 1 segundo de señal
t = np.linspace(0, 1, FS, endpoint=False)
# Señal Alpha (10 Hz) + Ruido de línea (50 Hz)
signal_alpha = np.sin(2 * np.pi * 10 * t)
signal_noise = 0.5 * np.sin(2 * np.pi * 50 * t)
noisy_signal = signal_alpha + signal_noise

# --- 3. Diseñar y Aplicar el Filtro ---
b, a = butter_bandpass(LOWCUT, HIGHCUT, FS, order=ORDER)
filtered_signal = apply_filter(noisy_signal, b, a)

# --- 4. Visualización ---
plt.figure(figsize=(12, 8))

# Graficar la respuesta en frecuencia de H(z)
w, h = freqz(b, a, worN=8000)
plt.subplot(2, 1, 1)
plt.plot(0.5 * FS * w / np.pi, np.abs(h), 'b')
plt.title('Respuesta en Frecuencia del Filtro Pasa-Banda (Alpha)')
plt.xlabel('Frecuencia (Hz)')
plt.ylabel('Ganancia')
plt.grid()
plt.axvspan(LOWCUT, HIGHCUT, color='yellow', alpha=0.3, label='Banda Alpha (8-12 Hz)')
plt.legend()

# Graficar señales
plt.subplot(2, 1, 2)
plt.plot(t, noisy_signal, 'r-', label='Señal Original (Ruido + Alpha)')
plt.plot(t, filtered_signal, 'b-', linewidth=2, label='Señal Filtrada (Solo Alpha)')
plt.title('Filtrado de Señal EEG Simulada')
plt.xlabel('Tiempo (s)')
plt.ylabel('Amplitud')
plt.legend()
plt.grid()

plt.tight_layout()
plt.show()
```

Este código demuestra el flujo completo:
1.  **Teoría (Transformada Z):** La función `butter` calcula los coeficientes $b_k$ y $a_k$ de $H(z)$ que cumplen con las especificaciones (pasa-banda de 8-12 Hz).
2.  **Práctica (Ecuación de Diferencia):** La función `lfilter` aplica eficientemente la ecuación de diferencia correspondiente a $H(z)$ para filtrar la señal `noisy_signal`.
3.  **Resultado:** La `filtered_signal` contiene principalmente la componente de 10 Hz (Alpha), mientras que el ruido de 50 Hz ha sido atenuado.

# 5. Conclusión

Las Transformadas de Laplace y Z son herramientas matemáticas abstractas pero con aplicaciones directas y fundamentales en la ingeniería biomédica.

La **Transformada de Laplace** sigue siendo esencial para el modelado, análisis y diseño de la circuitería analógica (como los filtros anti-aliasing y los amplificadores de biopotenciales) que forma la interfaz entre el paciente y el sistema digital. Proporciona un marco robusto para entender el comportamiento de sistemas en tiempo continuo.

La **Transformada Z** es la piedra angular del procesamiento digital de señales biomédicas. Cualquier operación de filtrado digital, ya sea para eliminar ruido de un ECG o para aislar bandas de frecuencia en un EEG, se describe y analiza matemáticamente en el dominio $z$. La capacidad de traducir una función de transferencia $H(z)$ en un algoritmo implementable (usando sus coeficientes $a_k$ y $b_k$) es lo que permite el análisis de señales moderno.

# 6. Referencias

[1] S. M. El-Khafif and M. A. M. El-Brawany, "A novel approach for ECG signal denoising and baseline wander correction based on empirical mode decomposition and Laplace transform," *Biomedical Signal Processing and Control*, vol. 86, p. 105252, Nov. 2023. DOI: 10.1016/j.bspc.2023.105252.

[2] R. K. Tripathy, S. Dehury, and S. R. S. S. J. T. o. M. S. i. P. S. Dash, "A novel approach for EEG signal classification based on Z-transform and deep learning," *Traitement du Signal*, vol. 40, no. 1, pp. 213–220, 2023. DOI: 10.18280/ts.400122.

[3] J. G. Proakis and D. G. Manolakis, *Digital Signal Processing*, 6th ed. New York, NY, USA: Pearson, 2023.
